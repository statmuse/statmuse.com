---
import MainLayout from '@layouts/main.astro'
import Header from '@components/header.astro'
import Container from '@components/container.astro'
import Image from '@components/image.astro'
import sample from 'lodash/sample'
import type { AnalyticsPageviewProperties } from '@lib/analytics'

interface Props {
  status?: number
  render: boolean
  message?: string
  query?: string
  image?: {
    url: string
    alt: string
  }
  analytics?: AnalyticsPageviewProperties
}

const images = [
  {
    url: Astro.url.origin + '/error/angry-lebron.png',
    alt: 'Illustration of Lebron James with angry expression',
  },
  {
    url: Astro.url.origin + '/error/confused-jr-smith.png',
    alt: 'Illustration of J.R. Smith with confused expression',
  },
  {
    url: Astro.url.origin + '/error/crying-jordan.png',
    alt: 'Illustration of Michael Jordan, crying',
  },
]

const { render, message, query, status, image = sample(images) } = Astro.props

if (render) {
  Astro.response.status = status
}
---

{
  render ? (
    <MainLayout
      {...Astro.props}
      colors={{ foreground: '#fff', background: '#0086ff' }}
    >
      <Header {query} />
      <Container class="mb-5 bg-team-primary text-team-secondary">
        <div class="flex flex-col md:flex-row pt-4 md:pt-6 relative">
          <div class="flex-1 flex flex-col justify-between text-center md:text-left">
            <h1
              data-cy-nlg
              class="font-semibold text-xl md:text-2xl md:leading-snug lg:text-[1.75rem] xl:text-3xl xl:leading-snug my-auto"
            >
              {message}
            </h1>
          </div>
          <Image
            class="h-44 md:h-52 self-center md:self-end mt-2 md:mt-0 md:pl-6 md:pr-1.5 select-none object-contain object-bottom"
            alt={image?.alt || ''}
            src={image?.url || ''}
            width={750}
            height={750}
            loading="eager"
          />
        </div>
      </Container>
    </MainLayout>
  ) : (
    <slot />
  )
}
