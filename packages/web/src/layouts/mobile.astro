---
import BaseLayout from '@layouts/base.astro'
import MoneyBaseLayout from '@layouts/money-base.astro'
import type { AnalyticsPageviewProperties } from '@lib/analytics'
import type { LeagueParam } from '@lib/params'
import type { NavLink } from 'src/types'
import type { ComponentProps } from 'astro/types'
import Nav from '@components/nav.astro'

interface Props extends ComponentProps<typeof BaseLayout> {
  league?: LeagueParam | 'All'
  page?: 'musings' | 'stats'
}

const { league = 'All', page, ...rest } = Astro.props

const links: NavLink[] = [
  { text: 'All', param: 'all', href: `/${page}` },
  { text: 'FC', param: 'fc' },
  { text: 'NBA', param: 'nba' },
  { text: 'NFL', param: 'nfl' },
  { text: 'NHL', param: 'nhl' },
  { text: 'MLB', param: 'mlb' },
  { text: 'PGA', param: 'pga' },
]

const Layout = league === 'money' ? MoneyBaseLayout : BaseLayout
const navProps = {
  links,
  selected: league.toLowerCase(),
  href: (league) => `/${league}/${page}`,
}
---

<Layout
  {...rest}
  analytics={{
    page_domain:
      league === 'All'
        ? 'sports'
        : league === 'money'
        ? 'finance'
        : league === 'fc'
        ? 'epl'
        : (league as AnalyticsPageviewProperties['page_domain']),
    page_type: 'mobile',
  }}
  preferredDomain={league === 'fc'
    ? 'epl'
    : league === 'All'
    ? undefined
    : league}
>
  <Nav {...navProps} />
  <slot />
</Layout>
