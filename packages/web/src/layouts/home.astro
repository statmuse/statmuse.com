---
import BaseLayout from '@layouts/base.astro'
import MoneyBaseLayout from '@layouts/money-base.astro'
import StandardLogo from '@components/logo.astro'
import MoneyLogo from '@components/logo-money.astro'
import AskBar from '@components/ask-bar.svelte'
import Footer from '@components/footer.astro'
import DropdownMenu from '@components/dropdown-menu.astro'
import MenuLinks from '@components/menu-links.astro'
import type { Metadata } from '@lib/meta'
import type { AnalyticsPageviewProperties } from '@lib/analytics'
import NewsletterSignup from '@components/newsletter-signup.astro'
import AuthMenu from '@components/auth-menu.svelte'
import Nav from '@components/nav.astro'
import type { LeagueParam } from '@lib/params'
import type { NavLink } from 'src/types'

interface Props {
  league?: LeagueParam | 'All'
  meta?: Metadata
  colors?: {
    foreground?: string
    background?: string
    foregroundColor?: string
    backgroundColor?: string
  }
}

const { league = 'All', ...rest } = Astro.props

const links: NavLink[] = [
  { text: 'All', param: 'all', href: '/' },
  { text: 'FC', param: 'fc' },
  { text: 'NBA', param: 'nba' },
  { text: 'NFL', param: 'nfl' },
  { text: 'NHL', param: 'nhl' },
  { text: 'MLB', param: 'mlb' },
  { text: 'PGA', param: 'pga' },
  { text: 'Money', param: 'money' },
]

const Layout = league === 'money' ? MoneyBaseLayout : BaseLayout
const Logo = league === 'money' ? MoneyLogo : StandardLogo
---

<Layout
  {...rest}
  analytics={{
    page_domain:
      league === 'All'
        ? 'sports'
        : league === 'money'
        ? 'finance'
        : league === 'fc'
        ? 'epl'
        : (league as AnalyticsPageviewProperties['page_domain']),
    page_type: 'home',
  }}
>
  <main class="md:flex">
    <div class="hidden md:block bg-gray-7">
      <div class="sticky top-0">
        <MenuLinks />
      </div>
    </div>

    <div
      class="md:hidden h-14 px-3 bg-gray-7 flex items-center sticky top-0 z-20"
    >
      <DropdownMenu />
      <Nav
        {links}
        selected={league.toLowerCase()}
        href={(league) => `/${league}`}
      />
    </div>

    <div class="px-3 bg-gray-7 max-w-3xl lg:max-w-5xl mx-auto">
      <div class="flex flex-1 justify-end md:mt-3">
        <AuthMenu client:load />
      </div>

      <div class="mt-8 mb-1 md:mb-3">
        <Logo />
      </div>

      <div class="sticky top-12 md:top-0 z-[5] pt-2 md:pt-3">
        <div class="absolute inset-0 h-14 md:h-16 bg-gray-7"></div>
        <AskBar
          large
          class="mx-auto"
          client:load
          money={league === 'money'}
          preferredDomain={league === 'All'
            ? undefined
            : league === 'fc'
            ? 'epl'
            : league}
        />
      </div>

      <div class="mt-3">
        <slot />
      </div>

      <NewsletterSignup />

      <Footer />
    </div>
  </main>
</Layout>
