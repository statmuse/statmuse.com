---
import Base from '@layouts/base.astro'
import AditudeAdBanner from '@components/aditude-ad-banner.svelte'
import type {
  GameResultsResponse,
  MlbGameDataResponse,
} from '@statmuse/core/gamera'
import PregameHero from './pregame-hero.astro'

interface Props {
  network: string
  timestamp: string
  awayTeam?: NonNullable<MlbGameDataResponse['teams']>[number]
  homeTeam?: NonNullable<MlbGameDataResponse['teams']>[number]
  awayScores?: GameResultsResponse
  homeScores?: GameResultsResponse
}

const { timestamp, network, awayTeam, homeTeam, awayScores, homeScores } =
  Astro.props

const { league, game } = Astro.params

const boxscorePreviewPath = ({
  league,
  game,
  team,
}: {
  league?: string
  game?: string
  team?: NonNullable<MlbGameDataResponse['teams']>[number]
}) =>
  `/${league}/game/${game}` +
  (team
    ? `/${team.nickname?.toLowerCase().split(' ').join('-')}-${team.teamId}`
    : '')

const navlinks = [
  {
    href: boxscorePreviewPath({ league, game }),
    text: 'Game',
  },
  {
    href: boxscorePreviewPath({ league, game, team: awayTeam }),
    text: awayTeam?.nickname,
    team: awayTeam,
  },
  {
    href: boxscorePreviewPath({ league, game, team: homeTeam }),
    text: homeTeam?.nickname,
    team: homeTeam,
  },
]
---

<Base headerClass="!bg-gray-6 dark:!bg-gray-4" renderRightColumn={false}>
  <PregameHero
    {network}
    {timestamp}
    {awayTeam}
    {homeTeam}
    {awayScores}
    {homeScores}
  />
  <div class="md:hidden h-[50px] md:h-[90px] flex justify-center items-center">
    <AditudeAdBanner
      client:only="svelte"
      divId="pb-slot-anchor"
      slotId="pb-slot-anchor"
      placeholderClass="w-[320px] md:w-[728px] h-[50px] md:h-[90px]"
      onlyMobile
    />
  </div>
  <nav class="flex gap-1.5 overflow-x-scroll no-scrollbar px-3 -mx-3">
    {
      navlinks.map((link) => (
        <a
          href={link.href}
          class:list={{
            'p-1 px-3 text-center whitespace-nowrap border rounded-full': true,
            'bg-gray-6 dark:bg-gray-3 text-gray-5 dark:text-gray-8': true,
            'border-gray-6 dark:border-gray-3': true,
            '!bg-gray-7 !text-gray-2': !link.team && !Astro.params.team,
          }}
          style={{
            background:
              link.team && link.href === Astro.url.pathname
                ? link.team.colors.backgroundColor
                : '',
            color:
              link.team && link.href === Astro.url.pathname
                ? link.team.colors.foregroundColor
                : '',
          }}
        >
          {link.text}
        </a>
      ))
    }
  </nav>
  <slot />
</Base>
