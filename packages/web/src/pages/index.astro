---
import HomeLayout from '@layouts/home.astro'
import Musings from '@components/musings.astro'
import { listOnboarding, type Example } from '@statmuse/core/examples'
import { Caching } from '@lib/caching'
import { db } from '@statmuse/core/db'

let banner: Example
try {
  const examples = await listOnboarding()
  banner = examples[Math.floor(Math.random() * examples.length)]
  db.destroy()
} catch (error) {
  console.error(error)
  return Astro.redirect('/404')
}

Caching.swr(Astro)
---

<HomeLayout img={{ src: banner, text: banner.text }}>
  <Musings />
</HomeLayout>
