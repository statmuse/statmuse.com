---
import Base from '@layouts/base.astro'
// import AditudeAdBanner from '@components/aditude-ad-banner.svelte'
import type { ComponentProps } from 'astro/types'
import type {
  GameraTeamReference,
  MlbGameStatus,
  NflGameStatus,
} from '@statmuse/core/gamera'

interface Props extends ComponentProps<typeof Base> {
  awayTeam?: GameraTeamReference
  homeTeam?: GameraTeamReference
  status: MlbGameStatus | NflGameStatus
  playByPlay?: boolean
}

const { awayTeam, homeTeam, status, playByPlay, ...rest } = Astro.props

const toggleLinks = [
  {
    label: 'preview',
    render: Astro.slots.has('preview'),
  },
  {
    label: 'summary',
    render: Astro.slots.has('summary'),
  },
  {
    label: 'game',
    render: Astro.slots.has('game'),
  },
  {
    label: 'away',
    render: Astro.slots.has('away'),
    team: awayTeam,
  },
  {
    label: 'home',
    render: Astro.slots.has('home'),
    team: homeTeam,
  },
  {
    label: 'drives',
    render: Astro.slots.has('drives'),
  },
  {
    label: 'team-stats',
    render: Astro.slots.has('team-stats'),
    text: 'Team Stats',
  },
  {
    label: 'plays',
    render: Astro.slots.has('plays') && playByPlay,
  },
]
---

<Base
  {...rest}
  share={{ url: Astro.url.href }}
  class="group/boxscore @container/boxscore"
>
  <slot name="hero" />
  <div
    class:list={{
      'flex gap-1.5 overflow-x-scroll no-scrollbar -mx-3 px-3': true,
      'md:hidden': status === 'scheduled',
      '@xl/boxscore:hidden': status !== 'scheduled',
    }}
  >
    {
      toggleLinks.map(
        (link) =>
          link.render && (
            <label
              class:list={{
                'p-1 px-3 text-center whitespace-nowrap border rounded-full capitalize cursor-pointer': true,
                'bg-gray-8 dark:bg-gray-3': true,
                'border-gray-6 dark:border-gray-3': true,
                'group-has-[#preview:checked]/boxscore:dark:bg-gray-7 group-has-[#preview:checked]/boxscore:dark:text-gray-2':
                  link.label === 'preview',
                'group-has-[#preview:checked]/boxscore:bg-teal group-has-[#preview:checked]/boxscore:text-gray-8':
                  link.label === 'preview',
                'group-has-[#summary:checked]/boxscore:dark:bg-gray-7 group-has-[#summary:checked]/boxscore:dark:text-gray-2':
                  link.label === 'summary',
                'group-has-[#summary:checked]/boxscore:bg-teal group-has-[#summary:checked]/boxscore:text-gray-8':
                  link.label === 'summary',
                'group-has-[#game:checked]/boxscore:dark:bg-gray-7 group-has-[#game:checked]/boxscore:dark:text-gray-2':
                  link.label === 'game',
                'group-has-[#game:checked]/boxscore:bg-teal group-has-[#game:checked]/boxscore:text-gray-8':
                  link.label === 'game',
                'group-has-[#plays:checked]/boxscore:dark:bg-gray-7 group-has-[#plays:checked]/boxscore:dark:text-gray-2':
                  link.label === 'plays',
                'group-has-[#plays:checked]/boxscore:bg-teal group-has-[#plays:checked]/boxscore:text-gray-8':
                  link.label === 'plays',
                'group-has-[#drives:checked]/boxscore:dark:bg-gray-7 group-has-[#drives:checked]/boxscore:dark:text-gray-2':
                  link.label === 'drives',
                'group-has-[#drives:checked]/boxscore:bg-teal group-has-[#drives:checked]/boxscore:text-gray-8':
                  link.label === 'drives',
                'group-has-[#team-stats:checked]/boxscore:dark:bg-gray-7 group-has-[#team-stats:checked]/boxscore:dark:text-gray-2':
                  link.label === 'team-stats',
                'group-has-[#team-stats:checked]/boxscore:bg-teal group-has-[#team-stats:checked]/boxscore:text-gray-8':
                  link.label === 'team-stats',
                'group-has-[#home:checked]/boxscore:bg-team-primary group-has-[#home:checked]/boxscore:text-team-secondary group-has-[#home:checked]/boxscore:border-team-primary':
                  link.label === 'home',
                'group-has-[#away:checked]/boxscore:bg-team-primary group-has-[#away:checked]/boxscore:text-team-secondary group-has-[#away:checked]/boxscore:border-team-primary':
                  link.label === 'away',
              }}
              style={
                link.team && {
                  '--team-primary-color': link.team?.colors?.backgroundColor,
                  '--team-secondary-color': link.team?.colors?.foregroundColor,
                }
              }
              for={link.label}
            >
              {link.team?.nickname ?? link.text ?? link.label}
            </label>
          ),
      )
    }
  </div>
  {
    Astro.slots.has('preview') && (
      <div class="hidden has-[#preview:checked]:flex flex-col gap-3">
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="preview"
          checked
        />
        <slot name="preview" />
      </div>
    )
  }
  {
    Astro.slots.has('summary') && (
      <div
        class:list={{
          'hidden has-[#summary:checked]:flex flex-col gap-3': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="summary"
          checked
        />
        <slot name="summary" />
      </div>
    )
  }
  {
    Astro.slots.has('game') && (
      <div
        class:list={{
          'hidden has-[#game:checked]:flex @xl/boxscore:!flex flex-col gap-3': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="game"
          checked
        />
        <slot name="game" />
      </div>
    )
  }
  {
    Astro.slots.has('box') && (
      <div
        class:list={{
          'hidden @xl/boxscore:has-[#box:checked]:flex flex-col gap-3': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="box"
        />
        <slot name="box" />
      </div>
    )
  }
  {
    Astro.slots.has('away') && (
      <div
        class:list={{
          'hidden has-[#away:checked]:flex flex-col gap-3': true,
          '@xl/boxscore:!hidden': status !== 'scheduled',
        }}
        style={{
          '--team-primary-color': awayTeam?.colors?.backgroundColor,
          '--team-secondary-color': awayTeam?.colors?.foregroundColor,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="away"
        />
        <slot name="away" />
      </div>
    )
  }
  {
    Astro.slots.has('home') && (
      <div
        class:list={{
          'hidden has-[#home:checked]:flex flex-col gap-3': true,
          '@xl/boxscore:!hidden': status !== 'scheduled',
        }}
        style={{
          '--team-primary-color': homeTeam?.colors?.backgroundColor,
          '--team-secondary-color': homeTeam?.colors?.foregroundColor,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="home"
        />
        <slot name="home" />
      </div>
    )
  }
  {
    Astro.slots.has('drives') && (
      <div
        class:list={{
          'hidden has-[#drives:checked]:flex flex-col gap-3': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="drives"
        />
        <slot name="drives" />
      </div>
    )
  }
  {
    Astro.slots.has('team-stats') && (
      <div
        class:list={{
          'hidden has-[#team-stats:checked]:flex flex-col gap-3': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="team-stats"
        />
        <slot name="team-stats" />
      </div>
    )
  }
  {
    Astro.slots.has('plays') && playByPlay && (
      <div
        class:list={{
          'hidden has-[#plays:checked]:flex flex-col gap-3 @xl/boxscore:!hidden': true,
        }}
      >
        <input
          class="absolute opacity-0"
          type="radio"
          name="boxscore"
          id="plays"
        />
        <slot name="plays" />
      </div>
    )
  }
  <slot />
  <slot name="modal" slot="modal" />
</Base>
