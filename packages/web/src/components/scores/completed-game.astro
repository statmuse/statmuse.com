---
import EntityLink from '@components/entity-link.astro'
import Image from '@components/image.astro'
import type {
  CompletedGame,
  GameraDomain,
  GameraTeamReference,
} from '@statmuse/core/gamera'
import dayjs from 'dayjs'

interface Props {
  game: CompletedGame
  awayTeam?: GameraTeamReference
  homeTeam?: GameraTeamReference
  domain: GameraDomain
  mini?: boolean
}

const { game, awayTeam, homeTeam, domain, mini } = Astro.props
---

<EntityLink
  entity={{
    id: game.id.toString(),
    type: 'game',
    display: `${dayjs(game.gameDate).format('M/D/YYYY')} ${
      awayTeam?.abbreviation
    } @ ${homeTeam?.abbreviation}`,
    domain,
  }}
  class="flex gap-3 py-2 px-3 text-inherit hover:no-underline"
>
  <div class="flex-1 w-max">
    <div
      class:list={{
        'flex justify-between gap-5 py-0.5': true,
        'font-semibold': game.awayTeam.gameResult === 'win',
      }}
    >
      <div class="flex gap-2 items-center">
        <Image
          src={awayTeam?.logoImageUrl ?? ''}
          alt={awayTeam?.name ?? ''}
          width={60}
          height={60}
          class="w-4 h-4 object-contain"
        />
        <p>{mini ? awayTeam?.abbreviation : awayTeam?.nickname}</p>
      </div>
      <p>{game.awayTeam.score}</p>
    </div>
    <div
      class:list={{
        'flex justify-between gap-5 py-0.5': true,
        'font-semibold': game.homeTeam.gameResult === 'win',
      }}
    >
      <div class="flex gap-2 items-center">
        <Image
          src={homeTeam?.logoImageUrl ?? ''}
          alt={homeTeam?.name ?? ''}
          width={60}
          height={60}
          class="w-4 h-4 object-contain"
        />
        <p>{mini ? homeTeam?.abbreviation : homeTeam?.nickname}</p>
      </div>
      <p>{game.homeTeam.score}</p>
    </div>
  </div>
  <div
    class:list={{
      'flex justify-end text-right text-sm text-gray-5': true,
      'items-center w-20': !mini,
      'py-1 pl-1.5': mini,
    }}
  >
    <p>Final</p>
  </div>
</EntityLink>
